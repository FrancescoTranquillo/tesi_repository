mydb <- dbConnect(sqlite, files[1])
View(mydb)
alltables = dbListTables(con)
alltables = dbListTables(mydb)
mydb <- dbConnect(sqlite, files[1])
getwd()
files[1]
mydb <- dbConnect(sqlite, "6-0014_1_isa.db3")
list.files(pattern = "*.db3")
mydb <- dbConnect(sqlite, "6-0014_1_isa.db3")
dbListTables(mydb)
files<-list.files(path)
dbpath<-paste0(path,"/",files[2])
mydb <- dbConnect(sqlite, dbpath)
library(tidyverse)
library(dplyr)
library(here)
library(pbapply)
library(forcats)
# funzione che dato in input uno scontrino lo trasforma in una tabella
morpher <- function(path_scontrino) {
scontrino <- readLines(paste0(path, "\\", path_scontrino))
scontrino_header <- scontrino[5:15]
scontrino_footer <- scontrino[16:length(scontrino)]
#trasformazione header
df_header <- data.frame(do.call(rbind,
strsplit(scontrino_header,
"(?<=[A-Z]): ",
perl = T)),
stringsAsFactors = F)
tmydf_header = setNames(data.frame(t(df_header[,-1])), df_header[, 1])
head(tmydf_header)
df <- tmydf_header
#trasformazione footer
df <- df %>%
mutate("CICLO REGOLARE" = ifelse(any(
grepl("CICLO IRREGOLARE", scontrino_footer) == TRUE
),-1, 1))
return(df)
}
#path = "C:\\Users\\frtranquillo\\github\\tesi_repository\\Data\\ISA\\isareport16-19\\16-17-18"
path <- here("isareport16-19")
lista_scontrini <- as.list(list.files(path, pattern = "*.txt"))
# applico funzione morpher ad ogni elemento della lista di scontrini e poi unisco
message("Analisi degli scontrini in corso...")
scontrino <- readLines("isareport16-19\2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt")
scontrino <- readLines(here("isareport16-19\2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"))
here("isareport16-19")
scontrino <- readLines(paste0(here("isareport16-19"), "\\","2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt")
scontrino <- readLines(paste0(here("isareport16-19"), "\\","2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"))
paste0(
here("isareport16-19"),
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
paste0(
here("isareport16-19"),
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
)
path=here("isareport16-19")
path=here("isareport16-19")
scontrino <- readLines(paste0(
path,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_header <- scontrino[5:15]
scontrino_footer <- scontrino[16:length(scontrino)]
scontrino
scontrino_footer <- scontrino[16:length(scontrino)]
scontrino_footer
"STERILIZZAZIONE" %in% scontrino_footer
"ACQUA" %in% scontrino_footer
grep("ACQUA",scontrino_footer)
grepl("ACQUA",scontrino_footer)
grepl("DETERSIONE",scontrino_footer)
library(tidyverse)
library(dplyr)
library(here)
library(pbapply)
library(forcats)
path=here("isareport16-19")
scontrino <- readLines(paste0(
path,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_footer <- scontrino[16:length(scontrino)]
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_footer1 <- scontrino[16:length(scontrino)]
rm(list=ls())
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_footer1 <- scontrino[16:length(scontrino1)]
library(here)
library(pbapply)
library(forcats)
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_footer1 <- scontrino[16:length(scontrino1)]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
))
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
path2=here("isareport16-19")
scontrino_footer1 <- scontrino[16:length(scontrino1)]
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
))
scontrino_footer2 <- scontrino[16:length(scontrino2)]
rm(list=ls())
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
scontrino_footer1 <- scontrino1[16:length(scontrino1)]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
))
scontrino_footer2 <- scontrino2[16:length(scontrino2)]
scontrino_footer1
View(scontrino_footer1)
View(scontrino_footer2)
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF8")
scontrino_footer1 <- scontrino1[16:length(scontrino1)]
View(scontrino_footer1)
View(scontrino_footer1)
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
scontrino_footer1 <- scontrino1[16:length(scontrino1)]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
),encoding = "UTF-8")
scontrino_footer2 <- scontrino2[16:length(scontrino2)]
View(scontrino_footer1)
View(scontrino_footer2)
clean_corpus <- function(corpus) {
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removeWords, stopwords)
corpus <- tm_map(corpus, stemDocument)
corpus <- tm_map(corpus, removeNumbers)
}
# funzione che dato in input uno scontrino lo trasforma in una tabella
morpher <- function(path_scontrino) {
scontrino <- readLines(paste0(path, "\\", path_scontrino))
scontrino_header <- scontrino[5:15]
scontrino_footer <- scontrino[16:length(scontrino)]
#trasformazione header
df_header <- data.frame(do.call(rbind,
strsplit(scontrino_header,
"(?<=[A-Z]): ",
perl = T)),
stringsAsFactors = F)
tmydf_header = setNames(data.frame(t(df_header[, -1])), df_header[, 1])
head(tmydf_header)
df <- tmydf_header
#trasformazione footer
df <- df %>%
mutate("CICLO REGOLARE" = ifelse(any(
grepl("CICLO IRREGOLARE", scontrino_footer) == TRUE
), -1, 1))
return(df)
}
#path = "C:\\Users\\frtranquillo\\github\\tesi_repository\\Data\\ISA\\isareport16-19\\16-17-18"
path <- here("isareport16-19")
lista_scontrini <- as.list(list.files(path, pattern = "*.txt"))
View(lista_scontrini)
clean_corpus <- function(corpus) {
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removeWords, stopwords)
corpus <- tm_map(corpus, stemDocument)
corpus <- tm_map(corpus, removeNumbers)
}
scontrino_corpus <- VCorpus(VectorSource(scontrino1))
library(tm)
clean_corpus <- function(corpus) {
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removeWords, stopwords)
corpus <- tm_map(corpus, stemDocument)
corpus <- tm_map(corpus, removeNumbers)
}
scontrino_corpus <- VCorpus(VectorSource(scontrino1))
scontrino_corpus_clean<-clean_corpus(scontrino_corpus)
scontrino_corpus <- VCorpus(VectorSource(scontrino1))
scontrino_corpus_clean<-clean_corpus(scontrino_corpus)
View(scontrino_corpus)
View(lista_scontrini)
View(scontrino_corpus)
bind_rows(scontrino)
bind_rows(scontrino1)
library(readr=)
library(readr)
scontrino1 <- read_file(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
)
scontrino1 <- read_file(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
))
clean_corpus <- function(corpus) {
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removeWords, stopwords)
corpus <- tm_map(corpus, stemDocument)
corpus <- tm_map(corpus, removeNumbers)
}
scontrino_corpus <- VCorpus(VectorSource(scontrino1))
scontrino_corpus_clean<-clean_corpus(scontrino_corpus)
View(scontrino_corpus)
View(scontrino_corpus)
scontrino1
scontrino_corpus <- tm_map(scontrino_corpus1, removePunctuation)
scontrino_corpus <- tm_map(scontrino_corpus, removePunctuation)
scontrino_corpus <- tm_map(scontrino_corpus, stripWhitespace)
scontrino_corpus <- tm_map(scontrino_corpus, content_transformer(tolower))
scontrino_corpus <- tm_map(scontrino_corpus, stemDocument)
scontrino_corpus <- tm_map(scontrino_corpus, removeWords)
scontrino_corpus <- tm_map(scontrino_corpus, removeNumbers)
scontrino_corpus
View(scontrino_corpus)
View(scontrino_corpus)
scontrino_corpus$`1`
scontrino_corpus[1]
clean_corpus <- function(corpus) {
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, stemDocument)
corpus <- tm_map(corpus, removeNumbers)
}
scontrino_corpus <- VCorpus(VectorSource(scontrino1))
scontrino_corpus_clean<-clean_corpus(scontrino_corpus)
descr_dtm <- DocumentTermMatrix(scontrino_corpus_clean)
View(scontrino_corpus_clean)
View(descr_dtm)
rm(list=ls())
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
scontrino_footer1 <- scontrino1[16:length(scontrino1)]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
),encoding = "UTF-8")
scontrino_footer2 <- scontrino2[16:length(scontrino2)]
View(scontrino_footer1)
library(lubridate)
hms(scontrino_footer1[1])
hms(scontrino_footer1)
View(scontrino_footer1)
lubridate::hms(scontrino_footer1[10])
strftime(scontrino_footer1[10], format="%H:%M:%S")
install.packages("chron")
times(scontrino_footer1[10])
library(chron)
library(chron)
times(scontrino_footer1[10])
lubridate::hms(scontrino_footer1[10])
Sys.setlocale("LC_TIME", "en_US")
Sys.setlocale("LC_TIME", "C")
lubridate::hms(scontrino_footer1[10])
lubridate::hms(scontrino_footer1)
parse_date_time(scontrino_footer1, orders = "%Y%m%d", exact = TRUE, truncated = 1)
parse_date_time(scontrino_footer1, orders = "%H%M%S", exact = TRUE, truncated = 1)
parse_date_time(scontrino_footer1, orders = "%H%M%S", exact = F, truncated = 1)
parse_date_time(scontrino_footer1, orders = "H:M:S", exact = F, truncated = 1)
parse_date_time(scontrino_footer1, orders = "H:M:S")
parse_date_time(scontrino_footer1)
parse_date_time(scontrino_footer1,orders = "I:M:S")
as.chron(scontrino_footer1, "%H:%M:%S")
ymd_hms(scontrino_footer1)
ymd_hms(scontrino_footer1[1],)
scontrino_footer1 <- scontrino1[16:length(scontrino1)]
ymd_hms(scontrino_footer1[1],)
ymd_hms(scontrino_footer1[1],tz ="America/Los_Angeles"))
ymd_hms(scontrino_footer1[1],tz ="America/Los_Angeles")
ymd_hms(scontrino_footer1,tz ="America/Los_Angeles")
scontrino_footer1[1]
str(scontrino_footer1[1])
ymd_hms(scontrino_footer1[1])
ymd_hms(scontrino_footer1[1],Sys.setlocale("LC_TIME", "C"), tz="UTC")
ymd_hms(scontrino_footer1[1], tz="UTC")
fast_strptime(scontrino_footer1)
fast_strptime(scontrino_footer1,"%H:%M:%S")
fast_strptime(scontrino_footer1,"H:M:S")
fast_strptime(scontrino_footer1,format = "H:M:S")
fast_strptime(scontrino_footer1[1],format = "H:M:S")
fast_strptime(scontrino_footer1[1],format = "HMS")
parse_date_time2(scontrino_footer1[1],format = "HMS")
parse_date_time2(scontrino_footer1[1])
parse_date_time2(scontrino_footer1[1],orders = "HMS")
parse_date_time2(scontrino_footer1,orders = "HMS")
substr(scontrino_footer1,1,8)
ymd_hms(substr(scontrino_footer1,1,8))
hms(substr(scontrino_footer1,1,8))
parse_time(substr(scontrino_footer1,1,8),format = "HMS")
parse_time(substr(scontrino_footer1,1,8),format = "H:M:S")
parse_time(substr(scontrino_footer1,1,8),format = "%H:%M:%S")
scontrino_footer1 <- scontrino1[16:length(scontrino1)-2]
rm(list=ls())
path1=here("isareport16-19")
library(tidyverse)
library(dplyr)
library(here)
library(pbapply)
library(forcats)
library(readr)
library(lubridate)
library(chron)
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
library(here)
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
scontrino_footer1 <- scontrino1[16:length(scontrino1)-2]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
),encoding = "UTF-8")
here("isareport16-19")
library(dplyr)
library(here)
library(pbapply)
library(forcats)
library(readr)
library(lubridate)
library(lubridate)
library(here)
unloadNamespace()
unloadNamespace(ns)
library(tidyverse)
library(dplyr)
library(lubridate)
library(here)
library(pbapply)
library(forcats)
library(readr)
path1=here("isareport16-19")
scontrino1 <- readLines(paste0(
path1,
"\\",
"2016-03-16 11.51 53 Strumento-G120201 Operatore-C.G..txt"
),encoding = "UTF-8")
scontrino_footer1 <- scontrino1[16:length(scontrino1)-2]
scontrino_footer1 <- scontrino1[16:(length(scontrino1)-2)]
scontrino_footer1 <- scontrino1[16:(length(scontrino1)-2)]
path2=here("isareport16-19")
scontrino2 <- readLines(paste0(
path2,
"\\",
"2018-04-16 14.51 3822 Strumento--B- G120516 Operatore-E.C.A..txt"
),encoding = "UTF-8")
scontrino_footer2 <- scontrino2[16:(length(scontrino2)-2)]
View(scontrino_footer1)
View(scontrino_footer2)
parse_time(substr(scontrino_footer1,1,8),format = "%H:%M:%S")
tempi <- parse_time(substr(scontrino_footer1,1,8),format = "%H:%M:%S")
tempi
str(tempi)
timediff(tempi)
timeDiff(tempi)
library(tidyverse)
library(dplyr)
library(lubridate)
library(here)
library(pbapply)
library(forcats)
library(readr)
difftime(tempi)
seq(1,length(tempi),2)
tempi1 <- tempi[seq(1,length(tempi),2),]
tempi[1]
tempi[1,3]
tempi[1,]
tempi1 <- tempi[seq(1,length(tempi),2)]
tempi2 <- tempi[-seq(1,length(tempi),2)]
difftime(tempi1,tempi2)
difftime(tempi2,tempi1)
dt <- difftime(tempi2,tempi1)
length(dt)
tempi2
length(tempi1,tempi2)
length(tempi1)
length(tempi2)
dt
cbind(tempi1, tempi2, dt)
cbind(as.string(tempi1), tempi2, dt)
cbind(as.character(tempi1), tempi2, dt)
cbind(as.character(tempi1), as.character(tempi2), dt)
difftime(tempi, lag(tempi, default = first(tempi)))
dt <- difftime(tempi, lag(tempi, default = first(tempi)))
barplot(dt)
hist(dt)
barplot(as.numeric(dt))
barplot(as.numeric(dt))
str(dt)
seq(1,length(dt),1)
cbind(paste0("t.",seq(1,length(dt),1)),dt)
t(cbind(paste0("t.",seq(1,length(dt),1)),dt))
barplot(t(cbind(paste0("t.",seq(1,length(dt),1)),dt)))
barplot(as.numeric(dt))
barplot(as.numeric(dt),names.arg = paste0("t.",seq(1,length(dt),1)))
barplot(as.numeric(dt),names.arg = paste0("t.",seq(1,length(dt),1)),main = "Tempo (in secondi) impiegato\nad eseguire il t-esimo processo")
t.labels <- paste0("t.", seq(1, length(dt), 1))
dt_table <- cbind(t.labels,dt)
df_header <- data.frame(do.call(rbind,
dt_table,
stringsAsFactors = F))
df_header <- data.frame(do.call(rbind,
dt_table))
dt_table <- data.frame(cbind(t.labels,dt))
View(dt_table)
tmydf_header = setNames(data.frame(t(dt_table[,-1])), dt_table[, 1])
dt_table[,-1]
dt_table <- data.frame(cbind(t.labels,as.numeric(dt))
tmydf_header = setNames(data.frame(t(dt_table[,-1])), dt_table[, 1])
dt_table <- data.frame(cbind(t.labels,as.numeric(dt))
tmydf_header = setNames(data.frame(t(dt_table[,-1])), dt_table[, 1]))
dt_table <- data.frame(cbind(t.labels,as.numeric(dt)))
tmydf_header = setNames(data.frame(t(dt_table[,-1])), dt_table[, 1])
data.frame(t(dt_table[,-1]))
dt_table[,-1]
glimpse(dt_table)
t(t_table)
t(dt_table)
a <- t(dt_table)
View(a)
View(dt_table)
t(dt_table[, -1]
)
dt_table[, 1]
tmydf_header = setNames(t(dt_table[, -1]), dt_table[, 1])
head(tmydf_header)
dt_table <- data.frame(cbind(t.labels, as.numeric(dt)))
tmydf_header = setNames(t(dt_table[, -1]), dt_table[, 1])
head(tmydf_header)
tmydf_header = setNames(data.frame(t(dt_table[, -1])), dt_table[, 1])
tmydf_header = setNames(as.data.frame(t(dt_table[, -1])), dt_table[, 1])
tmydf_header = setNames(t(dt_table[, -1]), dt_table[, 1])
head(tmydf_header)
tmydf_header
dt_table <- data.frame(cbind(t.labels, as.numeric(dt)),stringsAsFactors = F)
tmydf_header = setNames(t(dt_table[, -1]), dt_table[, 1])
head(tmydf_header)
tmydf_header = setNames(data.framet((dt_table[, -1])), dt_table[, 1])
tmydf_header = setNames(data.frame(t(dt_table[, -1])), dt_table[, 1])
head(tmydf_header)
View(tmydf_header)
